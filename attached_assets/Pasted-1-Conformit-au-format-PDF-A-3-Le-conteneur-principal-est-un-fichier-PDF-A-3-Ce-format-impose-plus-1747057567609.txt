1. ConformitÃ© au format PDF/A-3
Le conteneur principal est un fichier PDF/A-3. Ce format impose plusieurs contraintes strictes :

CritÃ¨re	DÃ©tail
Fonts	Toutes les polices doivent Ãªtre embarquÃ©es dans le PDF (pas de dÃ©pendance externe)
Couleurs	Les profils ICC doivent Ãªtre dÃ©finis (pas de DeviceRGB sans OutputIntent explicite)
Aucune action dynamique	Pas de JavaScript, de formulaires interactifs ou dâ€™hyperliens externes
Signatures numÃ©riques	Possibles mais doivent Ãªtre conformes Ã  la norme PAdES
MÃ©tadonnÃ©es XMP	Doivent Ãªtre prÃ©sentes, lisibles, et contenir : titre, auteur, date de crÃ©ation
Norme de conformitÃ©	Doit dÃ©clarer le profil PDF/A-3 via ConformanceLevel="B" ou U

ğŸ“ 2. IntÃ©gration du fichier XML (Factur-X XML)
Le fichier XML est embarquÃ© en piÃ¨ce jointe dans le PDF/A-3 via lâ€™annotation AFRelationship="Data".

CritÃ¨re	DÃ©tail
Nom de la piÃ¨ce jointe	factur-x.xml
MIME type	application/xml
Relation	AFRelationship="Data"
Lien logique	Lâ€™objet AF (Associated File) doit pointer depuis le PDF vers lâ€™XML
Encodage	UTF-8 sans BOM
Validation XML	Conforme au schÃ©ma XSD Factur-X (fourni par FNFE-MPE ou ZUGFeRD pour Allemagne)

ğŸ§  3. ValiditÃ© sÃ©mantique du fichier XML
Le XML embarque les donnÃ©es comptables. Il doit Ãªtre sÃ©mantiquement valide selon le profil Factur-X utilisÃ© :

Profil	DonnÃ©es obligatoires
MINIMUM	NumÃ©ro de facture, Ã©metteur, destinataire, date, montant total
BASIC WL	+ DÃ©tail des lignes, TVA, conditions de paiement
EN16931 (FULL)	+ NumÃ©rotation produit/service, rÃ©fÃ©rences commandes, remises, retenues

âš ï¸ Le format Factur-X peut Ãªtre rejetÃ© si :

Des champs requis manquent

Des champs ne respectent pas les types (ex : AmountCurrencyCode="EUR" attendu)

Des valeurs mal encodÃ©es (dates non ISO 8601, etc.)

ğŸ“¤ 4. MÃ©tadonnÃ©es PDF et structure de fichier
Factur-X exige un minimum de cohÃ©rence dans la structure du PDF :

Ã‰lÃ©ment	RÃ¨gle
PDF/A Identification	/PDF/AIdentification doit Ãªtre prÃ©sent avec /Part 3 et /Conformance B
XMP Metadata	Le bloc XMP doit reflÃ©ter les mÃ©tadonnÃ©es visibles dans le document
AFEntries	Table des fichiers associÃ©s (AF) doit contenir le XML uniquement
EmbeddedFiles	Le XML doit Ãªtre retrouvÃ© dans /EmbeddedFiles